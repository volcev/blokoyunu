/* ======================================
   MOBILE.CSS - ALL MOBILE OPTIMIZATIONS
   ====================================== */

/* ======================================
   MOBILE LAYOUT ADJUSTMENTS
   ====================================== */

/* General mobile fixes */
@media (max-width: 600px) {
  body {
    -webkit-text-size-adjust: 100%;
    -ms-text-size-adjust: 100%;
  }
  
  /* Prevent zoom on form inputs */
  input, select, textarea {
    font-size: 16px;
  }
}

/* ======================================
   ANDROID-SPECIFIC OPTIMIZATIONS
   ====================================== */
@supports (-webkit-appearance: none) {
  @media (max-width: 600px) and (orientation: portrait) {
    .content-container {
      min-height: calc(100dvh - 200px);
    }
    
    .banner-placeholder {
      height: calc(60px + env(safe-area-inset-top, 0px));
    }
  }
}

/* Android Chrome specific */
@media (max-width: 600px) {
  @supports not (-webkit-touch-callout: none) {
    .grid-container {
      -webkit-overflow-scrolling: touch;
    }
    
    .content-container {
      padding-bottom: env(safe-area-inset-bottom, 20px);
    }
  }
}

/* ======================================
   IOS-SPECIFIC OPTIMIZATIONS
   ====================================== */

/* iOS Safari/Chrome fixes */
@media (max-width: 600px) {
  @supports (-webkit-touch-callout: none) {
    /* iOS viewport handling */
    .app-container {
      height: -webkit-fill-available;
      min-height: -webkit-fill-available;
    }
    
    /* iOS safe area handling */
    .content-container {
      padding-bottom: max(20px, env(safe-area-inset-bottom));
    }
    
    /* iOS scroll bounce fix */
    .scrollable-content {
      -webkit-overflow-scrolling: touch;
      overscroll-behavior: none;
    }
  }
}

/* ======================================
   TOUCH OPTIMIZATIONS
   ====================================== */
@media (max-width: 600px) {
  /* Touch targets */
  .grid-block {
    min-width: 44px;
    min-height: 44px;
  }
  
  .action-button {
    min-height: 44px;
    touch-action: manipulation;
  }
  
  .menu-button {
    min-width: 44px;
    min-height: 44px;
    touch-action: manipulation;
  }
  
  /* Prevent text selection on touch */
  .grid-container,
  .button-group,
  .action-button {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
  }
  
  /* Smooth scrolling */
  .scrollable-content,
  .gridb-container {
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
  }
}

/* ======================================
   MOBILE KEYBOARD HANDLING
   ====================================== */
@media (max-width: 600px) {
  /* When keyboard is open */
  .modal-body {
    max-height: calc(100vh - 200px);
    overflow-y: auto;
  }
  
  /* iOS keyboard compensation */
  @supports (-webkit-touch-callout: none) {
    .modal-body {
      max-height: calc(100vh - env(keyboard-inset-height, 200px));
    }
  }
  
  /* Android keyboard compensation */
  @supports not (-webkit-touch-callout: none) {
    .modal-body {
      max-height: calc(100dvh - 200px);
    }
  }
}

/* ======================================
   MOBILE PERFORMANCE OPTIMIZATIONS
   ====================================== */
@media (max-width: 600px) {
  /* Reduce animations on mobile */
  .grid-block {
    transition: none;
  }
  
  .grid-block:hover {
    transform: none;
    box-shadow: none;
  }
  
  /* Optimize rendering */
  .grid-container {
    will-change: scroll-position;
    transform: translateZ(0);
  }
  
  /* Reduce repaints */
  .banner-placeholder,
  .button-group,
  .top-bar {
    will-change: transform;
    transform: translateZ(0);
  }
}

/* ======================================
   ORIENTATION HANDLING
   ====================================== */

/* Portrait orientation */
@media (max-width: 600px) and (orientation: portrait) {
  .grid-container {
    width: 95vw;
    max-width: 95vw;
  }
  
  .info {
    width: 95vw;
    max-width: 95vw;
  }
}

/* Landscape orientation */
@media (max-width: 900px) and (orientation: landscape) {
  .top-bar {
    height: 50px;
    padding: 0 16px;
  }
  
  .title {
    font-size: 1rem;
  }
  
  .welcome-header {
    font-size: 0.9rem;
  }
  
  .banner-placeholder {
    height: 40px;
    top: 50px;
  }
  
  .button-group {
    top: 94px; /* 50px + 40px + 4px */
    padding: 4px 0;
  }
  
  .content-container {
    margin-top: 140px; /* adjusted for landscape */
  }
  
  .header-overlay {
    height: 140px;
  }
}

/* ======================================
   VERY SMALL SCREENS (< 400px)
   ====================================== */
@media (max-width: 400px) {
  .title {
    font-size: 1rem;
  }
  
  .welcome-header {
    font-size: 0.85rem;
  }
  
  .action-button {
    padding: 6px 8px;
    font-size: 0.85rem;
  }
  
  .grid-block {
    font-size: 0.7rem;
  }
  
  .info {
    font-size: 0.9rem;
    padding: 8px 1vw 4px 1vw;
  }
}

@media (max-width: 600px) {
  @supports (-webkit-touch-callout: none) {
    .top-bar {
      position: fixed;
      top: env(safe-area-inset-top, 0px);
      left: 0;
      right: 0;
      width: 100vw;
      z-index: 1200;
      padding-top: env(safe-area-inset-top, 0px);
    }
    .banner-placeholder {
      position: fixed;
      top: calc(env(safe-area-inset-top, 0px) + 70px);
      left: 0;
      right: 0;
      width: 100vw;
      z-index: 1190;
      margin-top: 0;
    }
    .button-group {
      position: fixed;
      top: calc(env(safe-area-inset-top, 0px) + 130px);
      left: 0;
      right: 0;
      width: 100vw;
      z-index: 1180;
      margin-top: 0;
    }
    .content-container {
      margin-top: calc(env(safe-area-inset-top, 0px) + 182px);
    }
    .header-overlay {
      top: env(safe-area-inset-top, 0px);
      height: calc(env(safe-area-inset-top, 0px) + 182px);
    }
  }
  @supports not (-webkit-touch-callout: none) {
    .grid-container {
      width: 100%;
      max-width: 100%;
      min-width: 320px;
      margin: 0 auto;
      padding: 0;
      box-sizing: border-box;
      overflow-x: visible;
    }
    .gridb-container {
      width: 100vw;
      max-width: 100vw;
      min-width: 320px;
      margin: 0 auto;
      box-sizing: border-box;
      overflow-x: auto;
      overflow-y: auto;
    }
    .gridb-grid {
      min-width: 320px;
      margin-left: 0;
    }
  }
}